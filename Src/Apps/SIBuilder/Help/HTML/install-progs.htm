<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--
 * install-progs.htm
 *
 * HTML topic for use by HTML Help file.
 *
 * v1.0 of 29 Feb 2008 - Original version.
 * v1.1 of 11 Apr 2008 - Noted need for elevation on Windows Vista.
 *
 *
 * ***** BEGIN LICENSE BLOCK *****
 *
 * Version: MPL 1.1
 *
 * The contents of this file are subject to the Mozilla Public License Version
 * 1.1 (the "License"); you may not use this file except in compliance with the
 * License. You may obtain a copy of the License at http://www.mozilla.org/MPL/
 *
 * Software distributed under the License is distributed on an "AS IS" basis,
 * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for
 * the specific language governing rights and limitations under the License.
 *
 * The Original Code is install-progs.htm
 *
 * The Initial Developer of the Original Code is Peter Johnson
 * (http://www.delphidabbler.com/).
 *
 * Portions created by the Initial Developer are Copyright (C) 2008 Peter
 * Johnson. All Rights Reserved.
 *
 * Contributor(s): None
 *
 * ***** END LICENSE BLOCK *****
-->

<!--
	Adapted from topic in old WinHelp file
	Topic id: USINGINSTALLER
-->

<html>
	
<head>
	<meta
		http-equiv="Content-Type"
		content="text-html; charset=Windows-1252"
	>
	<title>Install and Uninstall</title>
	<link
		rel="stylesheet"
		href="../css/main.css"
		type="text/css"
	>
</head>

<body>
	<h1>
		Using Install and Uninstall
	</h1>

	<p>
		This topic discusses how to use the <span class="prog">Install</span>
		and the (optional) <span class="prog">Uninstall</span> programs
		generated by <span class="prog">SIBuilder</span>.
	</p>

	<h2>
		Using the Install program
	</h2>

	<p>
		The install program generated by <span class="prog">SIBuilder</span> is
		named according to the entry in the <span class="ui">Install program
		name</span> edit box on the <span class="prog">SIBuilder's</span>
		<a href="page-details.htm">Project Details page</a>.
		The install program file is written to the folder where the project
		(<span class="file">.sip</span>) file is stored. The remainder of this
		topic assumes the install program is named
		<span class="file">Install.exe</span>.
	</p>

	<p>
		The single install program file is all that is required to install the
		software project. It is executed by double clicking, by running from the
		Windows Run dialog box (<span class="smallcaps">Windows+R</span>), or by
		executing it from a DOS or command line session.
	</p>
	
	<div class="callout para-space">
		<span class="smallcaps">Note:</span>
		On the NT platform the install program requires administrator
		privileges. Windows Vista will also elevate the program.
	</div>

	<p>
		If the <span class="ui">Editing of installation path permitted?</span>
		check box on the
		<a href="page-details.htm">Project Details page</a> was checked then the
		person installing the software can override project's installation path.
		This is accomplished in one of two ways:
	</p>
	
	<ol class="spaced">
		<li>
			If the <span class="ui">Ask user for path on installation?</span>
			check box was not checked then execute
			<span class="file">Install.exe</span> from a command line (or from 
			the Windows Run dialog box
			(<span class="smallcaps">Windows+R</span>) and specify the required
			installation path on the program's command line. If the option to
			edit the path has not been set then
			<span class="file">Install.exe</span> will halt with an error
			message if a path is specified on the command line.
		</li>
		<li>
			If the <span class="ui">Ask user for path on installation?</span>
			check box was checked then execute
			<span class="file">Install.exe</span> in any way. The program will
			halt and display the default install path. The user should either
			press <span class="smallcaps">Return</span> to accept the default or
			type in the required path and press
			<span class="smallcaps">Return</span>.
		</li>
	</ol>


	<h2>
		Using the UnInstall program
	</h2>

	<p>
		<span class="file">Install.exe</span> optionally copies an uninstall
		program called <span class="file">UnInstall.exe</span> into the root of
		the specified installation path, along with a DLL named
		<span class="file">InstallLib.dll</span>. A data file named
		<span class="file">UnInstall.xml</span> is also copied into the same
		folder. The DLL is required by <span class="file">UnInstall.exe</span>
		to carry out the un-installation and the data file is needed to provide
		information about how to perform the uninstall. 
	</p>

	<p>
		Whether or not <span class="file">UnInstall.exe</span>,
		<span class="file">InstallLib.dll</span> and
		<span class="file">UnInstall.xml</span> are provided depends on whether
		the <a href="page-details.htm">Project Details page</a>'s
		<span class="ui">Create uninstall program?</span> checkbox is checked.
	</p>

	<p>
		The installer registers <span class="file">UnInstall.exe</span> with
		Control Panel's Add/Remove Programs applet. Therefore the installed
		software can be uninstalled by using the applet.
		<span class="file">UnInstall.exe</span> can also be run by double
		clicking it.
	</p>

	<div class="callout para-space">
		<span class="smallcaps">Note:</span>
		On the NT platform the uninstaller requires administrator privileges.
		Windows Vista will also elevate the program.
	</div>
	<p>
		<span class="file">UnInstall.exe</span> accepts no parameters.
	</p>

	<div class="callout para-space">
		<span class="smallcaps">Limitation:</span>
		<span class="file">UnInstall.exe</span> is incapable of removing itself
		from an installation. Therefore any folder containing the file will also
		not be removed regardless of the project settings.
	</div>
	
</body>

</html>
