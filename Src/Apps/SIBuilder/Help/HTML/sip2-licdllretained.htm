<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--
 * sip2-licdllretained.htm
 *
 * HTML topic for use by HTML Help file.
 *
 * v1.0 of 29 Feb 2008 - Original version.
 *
 *
 * ***** BEGIN LICENSE BLOCK *****
 *
 * Version: MPL 1.1
 *
 * The contents of this file are subject to the Mozilla Public License Version
 * 1.1 (the "License"); you may not use this file except in compliance with the
 * License. You may obtain a copy of the License at http://www.mozilla.org/MPL/
 *
 * Software distributed under the License is distributed on an "AS IS" basis,
 * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for
 * the specific language governing rights and limitations under the License.
 *
 * The Original Code is sip2-licdllretained.htm
 *
 * The Initial Developer of the Original Code is Peter Johnson
 * (http://www.delphidabbler.com/).
 *
 * Portions created by the Initial Developer are Copyright (C) 2008 Peter
 * Johnson. All Rights Reserved.
 *
 * Contributor(s): None
 *
 * ***** END LICENSE BLOCK *****
-->

<!--
	Adapted from topic in old WinHelp file
	Topic id: IDH_SIP2_LICDLLRETAINED
-->

<html>
	
<head>
	<meta
		http-equiv="Content-Type"
		content="text-html; charset=Windows-1252"
	>
	<title>SIP2: License DLL Retained</title>
	<link
		rel="stylesheet"
		href="../css/main.css"
		type="text/css"
	>
</head>

<body>
	<h1>
		v2 File Conversion Comment:<br>
		License Dialog DLL Retained Without Deletion
	</h1>

	<p>
		<span class="prog">SIBuilder</span> uses a DLL &ndash;
		<span class="file">SITLicenseDlg.dll</span> &ndash; to display any
		license required by the installer. <span class="file">SIBuilder 3</span>
		deletes the DLL once the license has been displayed, while
		<span class="prog">SIBuilder 2</span> stores the DLL in the installation
		folder and only (optionally) deletes it with the uninstaller.
	</p>

	<p>
		In the current case the DLL is not to be deleted by the uninstaller, but
		left on the user's system indefinately for use by other programs. To
		comply with this requirement <span class="prog">SIBuilder 3</span> has
		created a new
		<a href="def-groups.htm">group</a>
		&ndash; &quot;SIP2 CONVERTER: License DLL&quot
		&ndash; from which to install the license DLL into the
		<span class="file">[Windows]\PJsoft</span> folder.
		The uninstaller will not delete the DLL.
	</p>

	<p>
		The above technique was the only one available with
		<span class="prog">SIBuilder 2</span> when a file needed to be shared
		between applications. However, with <span class="prog">SIBuilder
		3</span> it is possible to explicitly flag a file for sharing between
		programs. A reference count is then kept and the program is only deleted
		when the reference count is zero. This alternative is recommended. The
		change can be made as follows:
	</p>

	<ol>
		<li>
			Go to the <a href="page-files.htm">Files page</a>.
		</li>
		<li>
			Select the &quot;SIP2 CONVERTER: License DLL&quot; group that was
			created by the program group and click the <span class="ui">Edit
			Group</span> button. In the resulting 
			<a href="dlg-editgroup.htm">Edit Group Properties</a>
			dialog box, select <span class="ui">Delete only files that were
			installed</span> in the <span class="ui">Files</span> section. Click
			<span class="ui">OK</span> to accept changes and close the dialog
			box.
		</li>
		<li>
			Select the file <span class="file">SITLicenseDlg.dll</span> under
			the above group and click the <span class="ui">Edit File</span>
			button to display the
			<a href="dlg-editfile.htm">Edit File Install Properties</a> dialog
			box. Check the <span class="ui">Register as shared DLL with
			Windows</span> check box and click <span class="ui">OK</span> to
			close the dialog box.
		</li>
	</ol>

	<p>
		Finally, the <span class="file">[Windows]\PJSoft</span> location is no
		longer used by <span class="prog">SIBuilder</span> for shared files from
		this suite &ndash;
		<span class="file">[Common&nbsp;Files]\DelphiDabbler</span> is now the
		preferred location. The &quot;SIP2 CONVERTER: License DLL&quot; group
		can be edited to use this new location by using the
		<a href="dlg-editgroup.htm">Edit Group Properities</a>
		dialog box once again.
	</p>

</body>

</html>
